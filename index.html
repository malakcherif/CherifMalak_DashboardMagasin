<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Shop Dashboard</title>
</head>
<style>
    body.dark, body.dark main{ 
        background-color: rgb(33, 54, 103); 
        color: #f5f5f5;
    }   
    body.dark header {
        background-color:rgb(33, 54, 103) ;
        color: whitesmoke;
    }
    body.dark h1{
        color: whitesmoke;
    }
    body.dark .infos ,body.dark .populaire{
        background-color: rgb(174, 188, 220); 
    }
    body.dark .class_ajoute{
        background-color: rgb(214, 209, 209); 
    }
    body.dark aside , body.dark footer  ,body.dark .box ,body.dark footer a{ 
        background-color: rgb(174, 188, 220); 
    } 
    body.dark button { 
        background-color: rgb(108, 112, 195); 
        color: white;
    }
    @media (max-width: 900px) {
        * {
            margin: 0;
            font-size: 13px;
            padding: 0;
        }
        body {
            height: auto;
            margin: 0;
            padding: 0;
        }
        header, footer {
            width: 100%;
            padding: 10px;
            margin: 0;
            text-align: center;
        }
        .container {
            flex-direction: column;
            width: 100%;
            align-items: center;
        }
        aside {
            width:90%;
            height: auto;
            margin-bottom: 20px;
            padding: 20px;
        }
        aside h2 {
            font-size: medium;
            margin-bottom: 15px;
        }
        aside ul {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            padding: 0;
        }
        aside ul li {
            margin: 0;
            padding: 10px;
            width: auto;
        }
        aside button {
            width: 90%;
            margin-top: 20px;
        }
        .filtrage {
            width: 100%;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .filtrage select,.filtrage button {
            padding: 10px;
            width: auto;
        }

        #card {
            flex-direction: column;
            align-items: center;
            gap: 15px;
            width: 100%;
            margin: 15px;
        }
        .infos {
            width: 90%;
            padding: 5px;
            height: auto;
        }
        .grid ,.class_ajoute {
            width: 100%;
            margin: 10px ;
            text-align: center;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
        }
        .class_ajoute img {
            width: 100%;
            height: auto;
        }

        .class_ajoute {
            width: 45%;
            padding: 10px;
        }

        .class_ajoute img {
            width: 80px;
            height: auto;
        }
        .chartjs {
            width: 100%;
            flex-direction: column;
            gap: 10px;
            padding: 10px;
        }
        .chartjs .box {
            width: 95%;
            margin: auto;
        }
        .chartjs canvas {
            width:auto ;
            height: auto ;
        }
    }

    * {
        box-sizing: border-box;
        margin: 8px;
        padding: 5px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: medium;
        color: black;
    }
    body { 
        margin: 0;
        height: 100%; 
        flex: 1;
        background-color: rgb(247, 246, 246);
    }
    @keyframes anim {
        0% {  scale: 1.8;}
        50% {  scale: 0.9;  }
        100% {  scale: 1.8; }
    }
    header {       
        background:beige;
        border-radius: 20px;
        text-align: center;
    }
    header h1{
        font-size:x-large;
        font-family:'Times New Roman', Times, serif;
        font-weight: bolder;
        font-style: italic;
        color: brown;
        animation: anim 4s ease-in-out infinite;
    }
    .container {
        display: flex;
        flex-direction: row;
    }
    main{
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    aside h2{
        margin-bottom: 150px;
        color: brown;
        font-size: x-large;
    }
    aside ul {
        list-style: none;
        padding: 0;
    }
    aside ul li  {
        gap: 10px;
        background-color: rgb(245, 225, 225); 
        border-radius:15px;
        margin: 15px ;
        padding: 15px;
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
    }
    aside ul li a{
        text-decoration: none;
        color: black;
        font-weight: 600;
        background-color: rgb(245, 225, 225);
    }
    aside ul li:hover ,aside ul a:hover {
        background-color: rgb(247, 243, 243); 
    }
    aside button{
        margin-top: 200px;
    }
    aside{
        background:beige;
        padding:20px;
        width:250px;
        border-radius: 20px;
        box-shadow:0 1px 5px palegoldenrod;
        flex-shrink: 0;
        align-items: center;
        justify-content: center;         
        text-align: center;
    }
    #card {
        display: flex; 
        gap: 20px; 
        flex-wrap: wrap; 
        margin: 20px;
    }
    h3{
        color: brown;
        font-size: 18px;
        font-weight: 600;
    }
    #card p{
        font-size: 15px;
        font-weight: 600;
    }
    .infos{
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color:#f4e1e1;
        text-align: center;
        justify-content: center;
        flex:1; 
        height: 100px; 
        padding: 20px; 
        border-radius: 12px;  
        gap:5px;
    }
    .filtrage {
        display: flex;
        flex-wrap: wrap; 
        justify-content: flex-end; 
        font-size:15px;
        gap: 5px; 
    }
    .filtrage select{
        border-radius: 12px;
        border: none;
        text-align: center;
        font-weight: 500;
        padding: 15px;
        background-color: #f1e2e2;
    }
    button{
        border-radius: 12px;
        padding: 12px;
        border: none;
        cursor: pointer;
        background-color: brown;
        color: beige;
    }
    button:hover{
        background-color: black;
        color: white;
    }
    aside h2{
        font-size: larger;
        text-transform: uppercase;
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        color: rgb(214, 136, 136);
    }
    footer,a{
        background:beige;
        color: black;
        text-align: center;
    }
    footer{
        border-radius: 20px;
        font-size: larger;
    }   
    a{
        font-size: 15px;
    }
    .populaire {
        margin: 30px;
        padding: 20px;
        border-radius: 20px;
        background-color: #f4e1e1;
        text-align: center;
    }    
    .grid {
        display: flex;
        justify-content: flex-start;
        gap: 15px;
        margin: 10px;
        width: 100px;
    }
    .populaire .grid  {
        display: flex;           
        justify-content: center;
        gap: 20px;               
        width: auto;
        border-radius: 12px;
        text-align: center; 
    }
    .grid img {
        align-items: center;
        width: 100%;
        border-radius:12px;
        height:100px;
        object-fit: cover;
    }
    .class_ajoute {
        padding: 10px;
        background: white;
        border-radius: 10px;
        margin: 5px;
        width: 150px;
        text-align: center;
    }
    .class_ajoute img {
        width: 100px;
        border-radius: 8px;
    }
    .class_ajoute img:hover {
        transform: scale(5);
        transition: transform 0.3s ease;
    }
    .class_ajoute h4{
        font-weight: bolder;
        color: brown;
    }
    .class_ajoute p span{
        font-weight:700 ;
    }
    .chartjs h3{
        font-size: 18px;
        font-weight: 600;
        text-align: center;
    }
    .chartjs {
        display: flex;
        gap: 20px;
        flex-wrap: wrap; 
        margin: 20px ;
        flex-direction: column;
    }
    .chartjs .box {
        width: auto;
        height: auto;
        background: white;
        border-radius: 15px;
    }
    
    .chartjs .box canvas {
        display: block;      
        margin: auto;  
    }
    .chartjs .box canvas:hover {
        transform: scale(1.5);
        transition: transform 0.3s ease;
    }

</style>
<body>
    <header>
      <h1>üõçÔ∏è Dashboard - Magasin en Ligne üõçÔ∏è</h1>
    </header>

    <div class="container">
        <aside >
            <h2>Magasin MC</h2>
            <ul>
                <li><a href="#accueil">Accueil</a></li>
                <li><a href="#prod_vente">Ventes</a></li>
                <li><a href="#prod_stock">Stock</a></li>
                <li><a href="#prod">Produits</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            
            <button id="toggleTheme">Mode Sombre üåô</button>    
        </aside>
        
        <main>
            <div class="filtrage" id="accueil">
                    <select id="category">
                        <option value="tous">Tous</option>
                        <option value="vetements" >V√™tements</option>
                        <option value="autres">Accessoires</option>
                        <option value="electro">El√©ctroniques</option>
                        <option value="decor">Meubles maison</option>
                    </select>

                    
                    <select id="period">
                        <option value="rien">P√©riode</option>
                        <option value="1">Dernier mois </option>
                        <option value="3">3 derniers mois</option>
                        <option value="6">6 derniers mois</option>
                    </select>        

                    <button id="start">‚Üì‚ÜëFiltrer</button>
                    <button id="reset">Annuler</button>
            </div>
                
            <div id="card">
                <div class="infos">
                    <h3>Ventes Totales</h3>
                    <p id="total">0 DT</p>
                </div>

                <div class="infos">
                    <h3>Produits en Stock</h3>
                    <p id="stock">0</p>
                </div>

                <div class="infos">
                    <h3>Meilleure Vente</h3>
                    <p id="meilleur">- - -</p>
                </div>
            </div>

                <div class="chartjs">
                    <div id="prod_vente">
                        <div class="box">
                            <h3>Suivi des ventes</h3>
                            <canvas id="venteChart"width="400" height="150"></canvas>
                        </div>
                    </div>

                    <div id="prod_stock">
                        <div class="box">
                            <h3>Suivi des stocks</h3>
                            <canvas id="stockChart" width="400" height="150"></canvas>
                        </div>
                    </div>
                </div>

                <div id="prod">

                    <div class="populaire">
                        <h3>Produits Populaires</h3>
                        <div class="grid" id="top">- - - -</div>
                    </div>
                    
                </div>    
        </main>
    </div>
    <footer id="contact">
        <h1>Pour signaler un probleme , voici le contact :</h1>
        <a href="mailto:malak.cherif@etudiant-fst.utm.tn">‚úâÔ∏è malak.cherif@etudiant-fst.utm.tn ‚úâÔ∏è</a>
    </footer>
    <script>

        // changer theme
        const btnMode=document.getElementById("toggleTheme")
        btnMode.addEventListener("click", () => {
            document.body.classList.toggle("dark"); //si le theme appliqu√© dark on l'enl√®ve sinon sera appliqu√©
            if(document.body.classList.contains("dark")){ // changer le texte des boutons
                btnMode.textContent = "Mode Clair  ‚òÄÔ∏è";
            } 
            else {
                btnMode.textContent = "Mode Sombre üåô";
            }
        });

        // les produits a suivre 
        const produits = [
            { nom: "Pc Mac", category: "electro", prix: 4500.99, stock:250, img: "https://cdn.pixabay.com/photo/2018/02/10/18/16/apple-3144234_640.jpg" },
            { nom: "Montre pour homme", category: "autres", prix:255.99, stock:120, img: "https://cdn.pixabay.com/photo/2022/12/14/16/10/ediffice-7655723_640.jpg" },
            { nom: "Salon", category: "decor", prix: 2500.5, stock:100, img: "https://cdn.pixabay.com/photo/2017/09/09/18/25/living-room-2732939_640.jpg" },
            { nom: "Salle √† manger", category: "decor", prix: 1570.5, stock:50, img: "https://cdn.pixabay.com/photo/2021/09/20/19/00/dinning-table-6641707_640.jpg" },
            { nom: "Set Tendance pour femme", category: "vetements", prix: 99.90, stock:35, img: "https://cdn.pixabay.com/photo/2020/05/22/14/59/fashion-5205675_960_720.jpg" },
            { nom: "Bijoux pour femme", category: "autres", prix: 67.99, stock:20, img: "https://cdn.pixabay.com/photo/2024/06/18/09/45/jewelry-8837559_640.png" },
            { nom: "Machine √† laver", category: "electro", prix:67.99, stock:20, img: "https://cdn.pixabay.com/photo/2016/01/28/22/07/washing-machine-1167053_640.jpg" },
            { nom: "Costume pour homme", category: "vetements", prix: 120.65, stock:15, img: "https://cdn.pixabay.com/photo/2017/08/10/08/00/suit-2619784_640.jpg" },  
        ];

        function calculVentesTotales(calcul) {
            let total = 0;
            calcul.forEach(p => total =total + p.prix); // calculer le prix total de tous les produits
            return total.toFixed(2); //2 chiffres seulement apres ,
        }

        function calculStockTotal(calcul) {
            let total = 0;
            calcul.forEach(p =>total =total + p.stock); // calculer tous les produits en stock
            return total;
        }

        function meilleurProduit(calcul) {
            let max = calcul.reduce((a, b) => a.stock > b.stock ? a : b); //comparer les produits selon leurs stocks 
            return max.nom;
        }

        function afficherProduitsPopulaires(best) {
            const top = document.getElementById("top");
            top.innerHTML = ""; // effacer ancien contenu

            best.slice(0,4).forEach(p => { // afficher seulement les 4 premiers 
                const card = document.createElement("div");
                card.className = "class_ajoute";
                card.innerHTML = `
                    <img src="${p.img}">
                    <h4>${p.nom}</h4>
                    <p><span>Prix : </span>${p.prix}DT</p>
                    <p><span>Stock : </span>${p.stock}</p>
                `;
                top.appendChild(card); //ajouter le produit dans la partie de  produits populaires
            });
        }

        function affichage(info) { //recuperer les donnees pour les afficher
            let total=document.getElementById("total");
            let stock=document.getElementById("stock");
            let meilleur=document.getElementById("meilleur");
            total.innerText = calculVentesTotales(info) + " DT"; // ecrire le prix total 
            stock.innerText = calculStockTotal(info); //ecrire le stock total
            meilleur.innerText = meilleurProduit(info); //ecrire le produit avec le stock le plus eleve
            afficherProduitsPopulaires(info); // ajouter les produits populaires
        }
       
        const category = document.getElementById("category");
        const period = document.getElementById("period");
        const filterBtn = document.getElementById("start");
        const resetBtn = document.getElementById("reset");
 
        // graphe vente et stock

        const venteJour = [56, 35, 15, 22, 17, 50, 63]; 
        const stockJour = [42, 78, 60, 12, 55, 33, 10]; 
        const xJour = ["Lun", "Mar", "Mer", "Jeu", "Ven", "Sam", "Dim"];

        const venteSem = [74, 67, 45, 96]; 
        const stockSem = [120, 88, 108, 150]; 
        const xSem = ["Sem-1", "Sem-2" ,"Sem-3" , "Sem-4"];

        const venteMois3 = [320, 250, 160]; 
        const stockMois3 = [400, 257, 231]; 
        const xMois3 = ["M-3", "M-2", "M-1"];

        const venteMois6 = [120, 250, 135, 150, 169, 210];
        const stockMois6 = [400, 274, 301, 380, 257, 231];
        const xMois6 = ["M-6", "M-5", "M-4", "M-3", "M-2", "M-1"];

        
        function graphe(tab, xtab,chartjs,color) {
            const canvas = document.getElementById(chartjs);
            const chart = canvas.getContext("2d");

            chart.clearRect(0, 0, canvas.width, canvas.height ); // effacer avant de commencer le dessin

            const largeur = 35; // la largeur des rectangles
            const space = 20; // les ecpaces  entres les rectangles
            let x = 10; //le debut de graphe

            chart.font = " 14px Arial";
            chart.textAlign="center";
        
            tab.forEach((val, i) => { //pour dessiner une barre pour chaque valeur de tab
                let h=val;
                if (h>100){
                    h=h/4; //minimiser l'hauteur pour la garder dans la carte
                }
                chart.fillStyle = color;
                chart.fillRect(x, canvas.height-h-30, largeur, h);

                chart.fillStyle = "black";
                chart.fillText(val, x + 10, canvas.height -h- 40); // pour ecrire valeur au dessus de la barre
                chart.fillText(xtab[i], x + 5, canvas.height -5); //  pour ecrire texte au dessous de la barre
                x += largeur + space; //espacement entre les barres du graphe
            });
        }    

        // filtrage
        function filtrer() {
            let val_cat = category.value;
            let val_period = period.value;
            let prod = produits;
            //filtrage selon categorie
            if (val_cat !== "tous") {
                prod = produits.filter(p => p.category === val_cat); //selectionner les produits de la categorie indiqu√©e
            }
            affichage(prod);
            //filtrage selon la periode
            if (val_period == "1") {
                graphe(venteSem, xSem,"venteChart","paleturquoise");
                graphe(stockSem, xSem,"stockChart","plum");
            }
            else if (val_period == "3") {
                graphe(venteMois3, xMois3,"venteChart","paleturquoise");
                graphe(stockMois3, xMois3,"stockChart","plum");
            }
            else if (val_period == "6") {
                graphe(venteMois6, xMois6,"venteChart","paleturquoise");
                graphe(stockMois6, xMois6,"stockChart","plum");
            }
            else {
                graphe(venteJour, xJour,"venteChart","paleturquoise");
                graphe(stockJour, xJour,"stockChart","plum");
            }
        }

        filterBtn.addEventListener("click", filtrer);

        graphe(venteJour, xJour,"venteChart","paleturquoise");
        graphe(stockJour, xJour,"stockChart","plum");

        //effacer filtrage
        function reset(){
            category.value="tous";
            period.value="rien";
            total.innerText="0 DT";
            stock.innerText="0";
            meilleur.innerText="- - -";
            let top=document.getElementById("top");
            top.innerText="- - - - -";
            graphe(venteJour, xJour,"venteChart","paleturquoise");
            graphe(stockJour, xJour,"stockChart","plum");
        }
        resetBtn.addEventListener('click', reset);
    </script>    
</body>
</html>