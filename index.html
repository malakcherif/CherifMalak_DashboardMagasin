<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Shop Dashboard</title>
</head>
<style>
    @media (max-width: 900px) {
        *{
            margin-bottom: 15px;
            font-size: 14px;
        }
        body{
            height:auto;
            margin: 0;
            padding: 0;
        }
        header , footer{
            width: 100%;
            
        }
        .container {
            flex-direction: column;
            align-items: center;
        }
        aside {
            width: 90%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        aside ul {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        aside button {
            margin-top: 0;
            width: 80%;
        }
        .filtrage {
            justify-content: center; 
            font-size: 12px;
            flex-wrap: wrap;
        }
        main .grid .card, main .class_ajoute {
            max-width: 400px;
            width: 90%;
        }

        main .grid img, main .class_ajoute img {
            height: auto;
            width: 100%;
        }
        .chartjs .box {
            width: 100%;
            height: auto;
        }
        .infos {
            justify-content: center;
            text-align: center;
        }
    }

    * {
        box-sizing: border-box;
        margin: 8px;
        padding: 5px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: medium;
        color: black;
    }
    body.dark, body.dark main{ 
        background-color: rgb(22, 37, 72); 
        color: #f5f5f5;
    }   
    body.dark header {
        background-color: rgb(22, 37, 72);
        color: whitesmoke;
    }
    body.dark .card , body.dark .infos ,body.dark .class_ajoute{
        background-color: #8d8db1; 
    }
    body.dark aside , body.dark footer ,body.dark .box { 
        background-color: #a9a9ca; 
    } 
    body.dark button { 
        background-color: grey; 
        color: white;
    }
    
    body { 
        margin: 0;
        height: 100%; 
        flex: 1;
        background-color: rgb(247, 246, 246);
    }
    @keyframes anim {
        0% { opacity: 1; }
        50% { opacity: 0.5;  }
        100% { opacity: 1;  }
    }
    header {       
        background:beige;
        border-radius: 20px;
        text-align: center;
        position: sticky;
        top: 0;
    }
    header h1{
        font-size:x-large;
        font-family:'Times New Roman', Times, serif;
        font-weight: bolder;
        font-style: italic;
        color: brown;
        animation: anim 2s ease-in-out infinite;
    }
    .container {
        display: flex;
        flex-direction: row;
    }
    main{
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    aside h2{
        margin-bottom: 150px;
        color: brown;
        font-size: x-large;
    }
    aside ul {
        list-style: none;
        padding: 0;
    }
    aside ul li   {
        gap: 10px;
        background-color: rgb(245, 225, 225); 
        border-radius:15px;
        margin: 15px ;
        padding: 15px;
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
    }
    aside ul li a{
        text-decoration: none;
        color: black;
        font-weight: 600;
        background-color: rgb(245, 225, 225);
    }
    aside ul li:hover ,aside ul a:hover {
        background-color: rgb(247, 243, 243); 
    }
    
    aside button{
        margin-top: 200px;
    }
    aside{
        background:beige;
        padding:20px;
        gap: 1px;
        width:250px;
        border-radius: 20px;
        box-shadow:0 1px 5px palegoldenrod;
        flex-shrink: 0;
        align-items: center;
        justify-content: center;         
        text-align: center;
    }
    #card {
        display: flex; 
        gap: 20px; 
        flex-wrap: wrap; 
        margin: 20px;
    }
    h3{
        color: brown;
        font-size: 18px;
        font-weight: 600;
    }
    #card p{
        font-size: 15px;
        font-weight: 600;
    }
    .infos{
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color:#f4e1e1;
        text-align: center;
        justify-content: center;
        flex:1; 
        height: 100px; 
        padding: 20px; 
        border-radius: 12px;  
        gap:5px;
    }
    .filtrage {
        display: flex;
        flex-wrap: wrap; 
        justify-content: flex-end; 
        font-size:15px;
        gap: 5px; 
    }
    .filtrage select{
        border-radius: 12px;
        border: none;
        text-align: center;
        font-weight: 500;
        padding: 15px;
        background-color: #f1e2e2;
    }
    button{
        border-radius: 12px;
        padding: 12px;
        border: none;
        cursor: pointer;
        background-color: brown;
        color: beige;
    }
    button:hover{
        background-color: black;
        color: white;
    }
    .chartjs h3{
        font-size: 18px;
        font-weight: 600;
    }
    aside h2{
        font-size: larger;
        text-transform: uppercase;
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
    }
    footer,a{
        background:beige;
        color: black;
        text-align: center;
    }
    footer{
        border-radius: 20px;
        font-size: larger;
    }   
    a{
        font-size: 15px;
    }    
    .grid {
        display: flex;
        justify-content: flex-start;
        gap: 15px;
        margin: 10px;
        width: 100px;
    }

    .grid .card {
        padding: 10px;
        border-radius: 12px;
        background-color: white;
        box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        text-align: center;
    }
    .grid img {
        align-items: center;
        width: 100%;
        border-radius:12px;
        height:100px;
        object-fit: cover;
    }
    .class_ajoute {
        padding: 10px;
        background: #f4e1e1;
        border-radius: 10px;
        margin: 5px;
        width: 150px;
        text-align: center;
    }
    .class_ajoute img {
        width: 100px;
        border-radius: 8px;
    }
    .class_ajoute h4{
        font-weight: bolder;
        color: brown;
    }
    .class_ajoute p span{
        font-weight:700 ;
    }
    .chartjs {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
        margin: 20px ;
    }
    .chartjs .box {
        width: 400px;
        height: auto;
        padding: 15px;
        background: white;
        border-radius: 12px;
    }

</style>
<body>
    <header>
      <h1>üõçÔ∏è Dashboard - Magasin en Ligne üõçÔ∏è</h1>
    </header>

    <div class="container">
        <aside >
            <h2>Magasin MC</h2>
            <ul>
                <li><a href="#acceuil">Accueil</a></li>
                <li><a href="#prod_vente">Ventes</a></li>
                <li><a href="#prod_stock">Stock</a></li>
                <li><a href="#prod">Produits</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            
            <button id="toggleTheme">üåô Mode Sombre</button>    
        </aside>
        
        <main>
            <div class="filtrage" id="acceuil">
                    <select id="category">
                        <option value="tous">Tous</option>
                        <option value="vetements" >V√™tements</option>
                        <option value="autres">Accessoires</option>
                        <option value="electro">El√©ctroniques</option>
                        <option value="decor">Meubles maison</option>
                    </select>

                    
                    <select id="period">
                        <option value="rien">P√©riode</option>
                        <option value="1">Dernier mois </option>
                        <option value="3">3 derniers mois</option>
                        <option value="6">6 derniers mois</option>
                    </select>        

                    <button id="start">‚Üì‚ÜëFiltrer</button>
                    <button id="reset">Annuler</button>
            </div>
                
            <div id="card">
                <div class="infos">
                    <h3>Ventes Totales</h3>
                    <p id="total">0 DT</p>
                </div>

                <div class="infos">
                    <h3>Produits en Stock</h3>
                    <p id="stock">0</p>
                </div>

                <div class="infos">
                    <h3>Produit Populaire</h3>
                    <p id="populaire">- - -</p>
                </div>
            </div>

                <div class="chartjs">
                    <div id="prod_vente">
                        <div class="box">
                            <h3>Suivie de ventes</h3>
                            <canvas id="venteChart"></canvas>
                        </div>
                    </div>

                    <div id="prod_stock">
                        <div class="box">
                            <h3>Suivie de stock</h3>
                            <canvas id="stockChart"></canvas>
                        </div>
                    </div>

                </div>

                <div id="prod">

                    <div class="meilleur">
                        <h3>Meilleurs Produits</h3>
                        <div class="grid" id="top"></div>
                    </div>
                    
                </div>    
        </main>
    </div>
    <footer id="contact">
        <h1>Pour signaler un probleme , voici le contact :</h1>
        <a href="malak.cherif@etudiant-fst.utm.tn">‚úâÔ∏è malak.cherif@etudiant-fst.utm.tn ‚úâÔ∏è</a>
    </footer>
    <script>
        // changer theme
        const btnMode=document.getElementById("toggleTheme")
        btnMode.addEventListener("click", () => {
            document.body.classList.toggle("dark");
            if(document.body.classList.contains("dark")){
                btnMode.textContent = "‚òÄÔ∏è Mode Clair";
            } else {
                btnMode.textContent = "üåô Mode Sombre";
            }
        });

        // les produits a suivre 
        const produits = [
            { nom: "Set Tendance pour femme", category: "vetements", prix: 99.90, stock: 35, img: "https://cdn.pixabay.com/photo/2020/05/22/14/59/fashion-5205675_960_720.jpg" },
            { nom: "Costume Bleu pour Homme", category: "vetements", prix: 120.65, stock: 15, img: "https://cdn.pixabay.com/photo/2017/08/10/08/00/suit-2619784_640.jpg" },
            { nom: "Montre", category: "autres", prix:255.99, stock: 120, img: "https://cdn.pixabay.com/photo/2022/12/14/16/10/ediffice-7655723_640.jpg" },
            { nom: "Bijoux : Boucles avec bagues", category: "autres", prix: 67.99, stock: 20, img: "https://cdn.pixabay.com/photo/2024/06/18/09/45/jewelry-8837559_640.png" },
            { nom: "Pc Mac", category: "electro", prix: 4500.99, stock: 250, img: "https://cdn.pixabay.com/photo/2018/02/10/18/16/apple-3144234_640.jpg" },
            { nom: "Machine √† laver", category: "electro", prix: 67.99, stock: 20, img: "https://cdn.pixabay.com/photo/2016/01/28/22/07/washing-machine-1167053_640.jpg" },
            { nom: "Salon", category: "decor", prix: 2500.5, stock: 100, img: "https://cdn.pixabay.com/photo/2017/09/09/18/25/living-room-2732939_640.jpg" },
            { nom: "Salle √† manger", category: "decor", prix: 1570.5, stock: 50, img: "https://cdn.pixabay.com/photo/2021/09/20/19/00/dinning-table-6641707_640.jpg" },
        ];

        function calculVentesTotales(calcul) {
            let total = 0;
            calcul.forEach(p => total =total + p.prix);
            return total.toFixed(2);
        }

        function calculStockTotal(calcul) {
            let total = 0;
            calcul.forEach(p =>total =total + p.stock);
            return total;
        }

        function produitPopulaire(calcul) {
            let max = calcul.reduce((a, b) => a.stock > b.stock ? a : b); //tcompari qui a stock plus eleve 
            return max.nom;
        }

        function afficherMeilleurProduits(best) {
            const top = document.getElementById("top");
            top.innerHTML = ""; // effacer ancien contenu

            best.sort((a, b) => b.stock - a.stock);

            best.slice(0, 3).forEach(p => {
                const card = document.createElement("div");
                card.className = "class_ajoute";
                card.innerHTML = `
                    <img src="${p.img}">
                    <h4>${p.nom}</h4>
                    <p><span>Prix :</span> \n ${p.prix} DT</p>
                    <p><span>Stock :</span> \n ${p.stock}</p>
                `;
                top.appendChild(card);
            });
        }

        function affichage(info) {
            let total=document.getElementById("total");
            let stock=document.getElementById("stock");
            let populaire=document.getElementById("populaire");
            total.innerText = calculVentesTotales(info) + " DT";
            stock.innerText = calculStockTotal(info);
            populaire.innerText = produitPopulaire(info);
            afficherMeilleurProduits(info);
        }

       
        const category = document.getElementById("category");
        const period = document.getElementById("period");
        const filterBtn = document.getElementById("start");
        const resetBtn = document.getElementById("reset");
 
        // graphe vente 
        function grapheVente(tab, xtab) {
            const canvas = document.getElementById("venteChart");
            const chart = canvas.getContext("2d");

            chart.clearRect(0, 0, canvas.width, canvas.height);

            const largeur = 30;
            const space = 20;
            let x = 15;

            const max = Math.max(...tab);

            chart.font = " 14px Arial";
            chart.textAlign="center";
        

            tab.forEach((val, i) => {
                let h = (val / max) * 100;

                chart.fillStyle = "paleturquoise";
                chart.fillRect(x, canvas.height - h - 30, largeur, h);

                chart.fillStyle = "black";
                chart.fillText(val, x + 10, canvas.height - h - 35); // ecrire valeur fou9 l barre
                chart.fillText(xtab[i], x + 5, canvas.height - 10); // ecrire texte taht l barre

                x += largeur + space;
            });
        }  

        const venteJour = [56, 35, 15, 22, 17, 50, 63]; 
        const xJour = ["Lun", "Mar", "Mer", "Jeu", "Ven", "Sam", "Dim"];

        const venteSem = [74, 67, 45, 96]; 
        const xSem = ["Sem-1", "Sem-2" ,"Sem-3" , "Sem-4"];

        const venteMois3 = [320, 250, 160]; 
        const xMois3 = ["M-3", "M-2", "M-1"];

        const venteMois6 = [120, 250, 135, 150, 169, 210];
        const xMois6 = ["M-6", "M-5", "M-4", "M-3", "M-2", "M-1"];

        

        // filtrage
        function filtrer() {
            let val_cat = category.value;
            let val_period = period.value;
            let prod = produits;

            if (val_cat !== "tous") {
                prod = produits.filter(p => p.category === val_cat);
            }
            affichage(prod);
            
            if (val_period == "1") {
                grapheVente(venteSem, xSem);
            }
            else if (val_period == "3") {
                grapheVente(venteMois3, xMois3);
            }
            else if (val_period == "6") {
                grapheVente(venteMois6, xMois6);
            }
            else {
                grapheVente(venteJour, xJour);
            }
            }
    
        filterBtn.addEventListener("click", filtrer);
        grapheVente(venteJour, xJour);

        //effacer filtrage
        function reset(){
            category.value="tous";
            period.value="rien";
            total.innerText="0 DT";
            stock.innerText="0";
            populaire.innerText="- - -";
            let top=document.getElementById("top");
            top.innerText="";
            const canvas = document.getElementById("venteChart");
            const chart = canvas.getContext("2d");
            chart.clearRect(0, 0, canvas.width, canvas.height);
        }
        resetBtn.addEventListener('click', reset);

    </script>    
</body>
</html>